(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21100d"],{b9ff:function(s,a,t){"use strict";t.r(a);var e=function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("hv-snippet",{attrs:{title:""}},[t("template",{slot:"title"},[t("p",[s._v("配置默认值")])]),t("p",[s._v("全局的 axios 默认值")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("axios.defaults.baseURL = "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"https://api.example.com"')]),s._v(";\naxios.defaults.headers.common["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Authorization"')]),s._v("] = AUTH_TOKEN;\naxios.defaults.headers.post["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Content-Type"')]),s._v("] =\n "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"application/x-www-form-urlencoded"')]),s._v(";\n")])]),t("p",[s._v("自定义实例默认值 :")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Set config defaults when creating the instance")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" instance = axios.create({\n "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("baseURL")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"https://api.example.com"')]),s._v(",\n});\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Alter defaults after instance has been created")]),s._v("\ninstance.defaults.headers.common["),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Authorization"')]),s._v("] = AUTH_TOKEN;\n")])]),t("p",[s._v("配置的优先顺序 :")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用由库提供的配置的默认值来创建实例")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 此时超时配置的默认值是 `0`")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" instance = axios.create();\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 覆写库的超时默认值")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 现在，在超时前，所有请求都会等待 2.5 秒")]),s._v("\ninstance.defaults.timeout = "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2500")]),s._v(";\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 为已知需要花费很长时间的请求覆写超时设置")]),s._v("\ninstance.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/longRequest"')]),s._v(", {\n "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("timeout")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5000")]),s._v(",\n});\n")])])],2),t("hv-snippet",{attrs:{title:""}},[t("template",{slot:"title"},[t("p",[s._v("拦截器")])]),t("p",[s._v("在请求或响应被 then 或 catch 处理前拦截它们。")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加请求拦截器")]),s._v("\naxios.interceptors.request.use(\n "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("config")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 在发送请求之前做些什么")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" config;\n },\n "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("error")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 对请求错误做些什么")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".reject(error);\n }\n);\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加响应拦截器")]),s._v("\naxios.interceptors.response.use(\n "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("response")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 对响应数据做点什么")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" response;\n },\n "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("error")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 对响应错误做点什么")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".reject(error);\n }\n);\n")])]),t("p",[s._v("如果你想在稍后移除拦截器，可以这样：")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" myInterceptor = axios.interceptors.request.use("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*...*/")]),s._v("\n});\naxios.interceptors.request.eject(myInterceptor);\n")])]),t("p",[s._v("可以为自定义 axios 实例添加拦截器 :")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" instance = axios.create();\ninstance.interceptors.request.use("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*...*/")]),s._v("\n});\n")])])],2),t("hv-snippet",{attrs:{title:""}},[t("template",{slot:"title"},[t("p",[s._v("错误处理")])]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("axios.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/user/12345"')]),s._v(").catch("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("error")]),s._v(") ")]),s._v("{\n "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (error.response) {\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// The request was made and the server responded with a status code")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// that falls out of the range of 2xx")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.response.data);\n   "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.response.status);\n   "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.response.headers);\n } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (error.request) {\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// The request was made but no response was received")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// `error.request` is an instance of XMLHttpRequest in the browser and an instance of")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// http.ClientRequest in node.js")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.request);\n } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Something happened in setting up the request that triggered an Error")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Error"')]),s._v(", error.message);\n }\n "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.config);\n});\n")])]),t("p",[s._v("也可以使用 validateStatus 配置选项定义一个自定义 HTTP 状态码的错误范围。：")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("axios.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/user/12345"')]),s._v(", {\n "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("validateStatus")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("status")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" status < "),t("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v("; "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Reject only if the status code is greater than or equal to 500")]),s._v("\n },\n});\n")])])],2),t("hv-snippet",{attrs:{title:""}},[t("template",{slot:"title"},[t("p",[s._v("取消")])]),t("p",[s._v("可以使用 CancelToken.source 工厂方法创建 cancel token，像这样：")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" CancelToken = axios.CancelToken;\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" source = CancelToken.source();\n\naxios\n .get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/user/12345"')]),s._v(", {\n   "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("cancelToken")]),s._v(": source.token,\n })\n .catch("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("thrown")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (axios.isCancel(thrown)) {\n     "),t("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Request canceled"')]),s._v(", thrown.message);\n   } "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n     "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 处理错误")]),s._v("\n   }\n });\n\naxios.post(\n "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/user/12345"')]),s._v(",\n {\n   "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"new name"')]),s._v(",\n },\n {\n   "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("cancelToken")]),s._v(": source.token,\n }\n);\n\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 取消请求（message 参数是可选的）")]),s._v("\nsource.cancel("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Operation canceled by the user."')]),s._v(");\n")])]),t("p",[s._v("还可以通过传递一个 executor 函数到 CancelToken 的构造函数来创建 cancel token：")]),t("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),t("pre",{pre:!0},[t("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" CancelToken = axios.CancelToken;\n"),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cancel;\naxios.get("),t("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/user/12345"')]),s._v(", {\n "),t("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("cancelToken")]),s._v(": "),t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" CancelToken("),t("span",{pre:!0,attrs:{class:"hljs-function"}},[t("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("executor")]),s._v("("),t("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("c")]),s._v(") ")]),s._v("{\n   "),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// executor 函数接收一个 cancel 函数作为参数")]),s._v("\n   cancel = c;\n }),\n});\n"),t("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// cancel the request")]),s._v("\ncancel();\n")])])],2)],1)},r=[],n=t("2877"),p={},l=Object(n["a"])(p,e,r,!1,null,null,null);a["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d21100d.d00b1ff2.js.map