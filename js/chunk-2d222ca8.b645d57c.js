(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d222ca8"],{cfb1:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("Node.js Stream(流)")])]),a("p",[s._v("Stream 是一个抽象接口，例如对 http 服务器发起请求的 request 对象就是一个 Stream，还有 stdout（标准输出）。\nNode.js，Stream 有四种流类型：")]),a("ol",[a("li",[s._v("Readable - 可读操作。")]),a("li",[s._v("Writable - 可写操作。")]),a("li",[s._v("Duplex - 可读可写操作.")]),a("li",[s._v("Transform - 操作被写入数据，然后读出结果。")])]),a("p",[s._v("所有的 Stream 对象都是 EventEmitter 的实例。常用的事件有：")]),a("ol",[a("li",[s._v("data - 当有数据可读时触发。")]),a("li",[s._v("end - 没有更多的数据可读时触发。")]),a("li",[s._v("error - 在接收和写入过程中发生错误时触发。")]),a("li",[s._v("finish - 所有数据已被写入到底层系统时触发。")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("从流中读取数据")])]),a("p",[s._v("input.txt 文件")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-txt"},[s._v("txt")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("菜鸟教程官网地址：www.runoob.com\n")])]),a("p",[s._v("案例")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('""')]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建可读流")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" readerStream = fs.createReadStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input.txt"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 设置编码为 utf8。")]),s._v("\nreaderStream.setEncoding("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"UTF8"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 处理流事件 --\x3e data, end, and error")]),s._v("\nreaderStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("chunk")]),s._v(") ")]),s._v("{\n data += chunk;\n});\nreaderStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"end"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(data);\n});\nreaderStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("err")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err.stack);\n});\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"程序执行完毕"')]),s._v(");\n")])]),a("p",[s._v("执行结果")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("程序执行完毕\n菜鸟教程官网地址：www.runoob.com\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("写入流")])]),a("p",[s._v("案例")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"菜鸟教程官网地址：www.runoob.com"')]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个可以写入的流，写入到文件 output.txt 中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" writerStream = fs.createWriteStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"output.txt"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用 utf8 编码写入数据")]),s._v("\nwriterStream.write(data, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"UTF8"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 标记文件末尾")]),s._v("\nwriterStream.end();\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 处理流事件 --\x3e data, end, and error")]),s._v("\nwriterStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"finish"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"写入完成。"')]),s._v(");\n});\nwriterStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("err")]),s._v(") ")]),s._v("{\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(err.stack);\n});\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"程序执行完毕"')]),s._v(");\n")])]),a("p",[s._v("执行结果")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("程序执行完毕\n写入完成。\n")])]),a("p",[s._v("output.txt 文件的内容")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-node"},[s._v("node")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-node"}},[s._v("$ cat output.txt\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("菜鸟教程官网地址：www.runoob.com\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("管道流")])]),a("p",[s._v("管道提供了一个输出流到输入流的机制。通常我们用于从一个流中获取数据并将数据传递到另外一个流中。")]),a("p",[s._v("input.txt 文件")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-txt"},[s._v("txt")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("菜鸟教程官网地址：www.runoob.com\n管道流操作实例\n")])]),a("p",[s._v("案例")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个可读流")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" readerStream = fs.createReadStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input.txt"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个可写流")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" writerStream = fs.createWriteStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"output.txt"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 管道读写操作")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 读取 input.txt 文件内容，并将内容写入到 output.txt 文件中")]),s._v("\nreaderStream.pipe(writerStream);\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"程序执行完毕"')]),s._v(");\n")])]),a("p",[s._v("执行结果")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("程序执行完毕\n")])]),a("p",[s._v("output.txt 文件的内容")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-node"},[s._v("node")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-node"}},[s._v("$ cat output.txt\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("菜鸟教程官网地址：www.runoob.com\n管道流操作实例\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("链式流")])]),a("p",[s._v("链式是通过连接输出流到另外一个流并创建多个流操作链的机制。链式流一般用于管道操作。")]),a("p",[s._v("input.txt 文件")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-txt"},[s._v("txt")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("菜鸟教程官网地址：www.runoob.com\n链式流操作实例\n")])]),a("p",[s._v("文件压缩")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" zlib = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'zlib'")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 压缩 input.txt 文件为 input.txt.gz")]),s._v("\nfs.createReadStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input.txt'")]),s._v(")\n .pipe(zlib.createGzip())\n .pipe(fs.createWriteStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input.txt.gz'")]),s._v("));\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"文件压缩完成。"')]),s._v(");\n")])]),a("p",[s._v("执行结果")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("文件压缩完成。\n")])]),a("p",[s._v("文件解压")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" zlib = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'zlib'")]),s._v(");\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 解压 input.txt.gz 文件为 input.txt")]),s._v("\nfs.createReadStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input.txt.gz'")]),s._v(")\n .pipe(zlib.createGunzip())\n .pipe(fs.createWriteStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'output.txt'")]),s._v("));\n \n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"文件解压完成。"')]),s._v(");\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("文件解压完成。\n")])]),a("p",[s._v("output.txt 文件的内容")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-node"},[s._v("node")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-node"}},[s._v("$ cat output.txt\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("菜鸟教程官网地址：www.runoob.com\n链式流操作实例\n")])]),a("blockquote",[a("p",[s._v("先将 input.txt 生成压缩文件 input.txt.gz，再将压缩文件解压成 output.txt")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("input里面的内容写到outInput里面")])]),a("p",[s._v("input.txt 文件")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-txt"},[s._v("txt")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("菜鸟教程官网地址：www.runoob.com\n文件合并input.txt\n")])]),a("p",[s._v("output.txt 文件")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-txt"},[s._v("txt")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("菜鸟教程官网地址：www.runoob.com\n文件合并output\n")])]),a("p",[s._v("文件合并")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//引入fs模块")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fs =  "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//封装请求文件数据的函数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("getFileData")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fileName")]),s._v(")")]),s._v("{\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve")]),s._v("=>")]),s._v("{\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" readStream = fs.createReadStream(fileName)  \n   readStream.setEncoding("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'UTF8'")]),s._v(")\n   readStream.on("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(",chunk=>resolve(chunk))\n })\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//并发请求")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v(".all([getFileData("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input.txt"')]),s._v("),getFileData("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"output.txt"')]),s._v(")]).then("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("result")]),s._v("=>")]),s._v("{\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" writeStream = fs.createWriteStream("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"output.txt"')]),s._v(");\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//讲两个文件的内容重新再写入到output.txt中")]),s._v("\n  writeStream.write(result["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("]+"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('","')]),s._v("+result["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("],"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"UTF8"')]),s._v(");\n  writeStream.end();\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//再获取output.txt文件的内容")]),s._v("\n  fs.readFile("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"output.txt"')]),s._v(",(err,content)=>"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(content.toString()))\n})\n")])])],2)],1)},e=[],p=a("2877"),n={},v=Object(p["a"])(n,r,e,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d222ca8.b645d57c.js.map