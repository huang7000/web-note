(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2389f8"],{ffbd:function(s,t,e){"use strict";e.r(t);var r=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("section",[e("hv-snippet",{attrs:{title:""}},[e("template",{slot:"title"},[e("p",[s._v("Node.js EventEmitter")])]),e("p",[s._v("events 模块只提供了一个对象： events.EventEmitter。EventEmitter 的核心就是事件触发与事件监听器功能的封装。")]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 引入 events 模块")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" events = "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"events"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建 eventEmitter 对象")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" eventEmitter = "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" events.EventEmitter();\n")])]),e("p",[s._v("案例")]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" events = "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"events"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" emitter = "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" events.EventEmitter();\nemitter.on("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"someEvent"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg1, arg2")]),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"listener1"')]),s._v(", arg1, arg2);\n});\nemitter.on("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"someEvent"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg1, arg2")]),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"listener2"')]),s._v(", arg1, arg2);\n});\nemitter.emit("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"someEvent"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"arg1 参数"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"arg2 参数"')]),s._v(");\n")])]),e("p",[s._v("执行结果")]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("listener1 arg1 参数 arg2 参数\nlistener2 arg1 参数 arg2 参数\n")])])],2),e("hv-snippet",{attrs:{title:""}},[e("template",{slot:"title"},[e("p",[s._v("方法")])]),e("div",{staticClass:"hv-snippet--table"},[e("table",[e("thead",[e("tr",[e("th",[s._v("方法")]),e("th",[s._v("描述")])])]),e("tbody",[e("tr",[e("td",[e("code",{pre:!0},[s._v("addListener(event, listener)")])]),e("td",[s._v("为指定事件添加一个监听器到监听器数组的尾部。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("on(event, listener)")])]),e("td",[s._v("为指定事件注册一个监听器，接受一个字符串 event 和一个回调函数。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("once(event, listener)")])]),e("td",[s._v("为指定事件注册一个单次监听器，即 监听器最多只会触发一次，触发后立刻解除该监听器。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("removeListener(event, listener)")])]),e("td",[s._v("移除指定事件的某个监听器，监听器必须是该事件已经注册过的监听器。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("removeAllListeners([event])")])]),e("td",[s._v("移除所有事件的所有监听器， 如果指定事件，则移除指定事件的所有监听器。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("setMaxListeners(n)")])]),e("td",[s._v("默认情况下， 监听器超过 10 个就会输出警告信息。 修改监听器的默认限制的数量。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("listeners(event)")])]),e("td",[s._v("返回指定事件的监听器数组。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("emit(event, [arg1], [arg2], [...])")])]),e("td",[s._v("按监听器的顺序执行执行每个监听器，如果事件有注册监听返回 true，否则返回 false。")])])])])]),e("div",{staticClass:"hv-snippet--table"},[e("table",[e("thead",[e("tr",[e("th",[s._v("类方法")]),e("th",[s._v("描述")])])]),e("tbody",[e("tr",[e("td",[e("code",{pre:!0},[s._v("listenerCount(emitter, event)")])]),e("td",[s._v("返回指定事件的监听器数量。")])])])])]),e("div",{staticClass:"hv-snippet--table"},[e("table",[e("thead",[e("tr",[e("th",[s._v("方法")]),e("th",[s._v("描述")])])]),e("tbody",[e("tr",[e("td",[e("code",{pre:!0},[s._v("newListener")])]),e("td",[s._v("event - 字符串，事件名称。listener - 处理事件函数。该事件在添加新监听器时被触发。")])]),e("tr",[e("td",[e("code",{pre:!0},[s._v("removeListener")])]),e("td",[s._v("event - 字符串，事件名称。listener - 处理事件函数。从指定监听器数组中删除一个监听器。会修改索引。")])])])])]),e("p",[s._v("语法")]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("server.on("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("stream")]),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"someone connected!"')]),s._v(");\n});\n\nserver.once("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("stream")]),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Ah, we have our first user!"')]),s._v(");\n});\n\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" callback = "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("stream")]),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"someone connected!"')]),s._v(");\n};\nserver.on("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", callback);\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\nserver.removeListener("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", callback);\n\nevents.EventEmitter.listenerCount(emitter, eventName); "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//已废弃，不推荐")]),s._v("\nevents.emitter.listenerCount(eventName); "),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//推荐")]),s._v("\n")])])],2),e("hv-snippet",{attrs:{title:""}},[e("template",{slot:"title"},[e("p",[s._v("方法案例")])]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" events = "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"events"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" eventEmitter = "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" events.EventEmitter();\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 监听器 #1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" listener1 = "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("listener1")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"监听器 listener1 执行。"')]),s._v(");\n};\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 监听器 #2")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" listener2 = "),e("span",{pre:!0,attrs:{class:"hljs-function"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),e("span",{pre:!0,attrs:{class:"hljs-title"}},[s._v("listener2")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"监听器 listener2 执行。"')]),s._v(");\n};\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 绑定 connection 事件，处理函数为 listener1")]),s._v("\neventEmitter.addListener("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", listener1);\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 绑定 connection 事件，处理函数为 listener2")]),s._v("\neventEmitter.on("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", listener2);\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" eventListeners = eventEmitter.listenerCount("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(eventListeners + "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 个监听器监听连接事件。"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 处理 connection 事件")]),s._v("\neventEmitter.emit("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 移除监绑定的 listener1 函数")]),s._v("\neventEmitter.removeListener("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(", listener1);\n"),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"listener1 不再受监听。"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 触发连接事件")]),s._v("\neventEmitter.emit("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(");\neventListeners = eventEmitter.listenerCount("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"connection"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(eventListeners + "),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 个监听器监听连接事件。"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"程序执行完毕。"')]),s._v(");\n")])])],2),e("hv-snippet",{attrs:{title:""}},[e("template",{slot:"title"},[e("p",[s._v("error 事件")])]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" events = "),e("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"events"')]),s._v(");\n"),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" emitter = "),e("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" events.EventEmitter();\nemitter.emit("),e("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v(");\n")])]),e("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),e("pre",{pre:!0},[e("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("throw e; // process.nextTick error, or 'error' event on first tick\n^\nError: Uncaught, unspecified 'error' event.\nat EventEmitter.emit (events.js:50:15)\nat Object.<anonymous> (/home/byvoid/error.js:5:9)\nat Module._compile (module.js:441:26)\nat Object..js (module.js:459:10)\nat Module.load (module.js:348:31)\nat Function._load (module.js:308:12)\nat Array.0 (module.js:479:10)\nat EventEmitter._tickCallback (node.js:192:40)\n")])])],2)],1)},n=[],a=e("2877"),v={},l=Object(a["a"])(v,r,n,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d2389f8.51da54f5.js.map