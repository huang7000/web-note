(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d225f0d"],{e716:function(t,s,a){"use strict";a.r(s);var e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("section",[a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("Mutation")])]),a("p",[t._v("更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。Vuex 中的 mutation 非常类似于事件：每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数：")]),a("blockquote",[a("p",[t._v("一条重要的原则就是要记住 mutation 必须是同步函数。")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("const")]),t._v(" store = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("new")]),t._v(" Vuex.Store({\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("state")]),t._v(": {\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("count")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[t._v("1")]),t._v(",\n },\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("mutations")]),t._v(": {\n   increment(state) {\n     "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// 变更状态")]),t._v("\n     state.count++;\n   },\n },\n});\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("//要唤醒一个 mutation handler，你需要以相应的 type 调用 store.commit 方法：")]),t._v("\nstore.commit("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"increment"')]),t._v(");\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("提交载荷（Payload）")])]),a("p",[t._v("向 store.commit 传入额外的参数，即 mutation 的 载荷（payload）：")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("mutations")]),t._v(": {\n increment (state, n) {\n   state.count += n\n }\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("//要唤醒一个 mutation handler，你需要以相应的 type 调用 store.commit 方法：")]),t._v("\nstore.commit("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v("'increment'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[t._v("10")]),t._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("//在大多数情况下，载荷应该是一个对象，这样可以包含多个字段并且记录的 mutation 会更易读：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("mutations")]),t._v(": {\n increment (state, payload) {\n   state.count += payload.amount\n }\n}\nstore.commit("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v("'increment'")]),t._v(", {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("amount")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[t._v("10")]),t._v("\n})\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("对象风格的提交方式")])]),a("p",[t._v("提交 mutation 的另一种方式是直接使用包含 type 属性的对象：")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t._v("store.commit({\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("type")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v("'increment'")]),t._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("amount")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[t._v("10")]),t._v("\n})\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("//使用对象风格的提交方式，整个对象都作为载荷传给 mutation 函数，因此 handler 保持不变：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("mutations")]),t._v(": {\n increment (state, payload) {\n   state.count += payload.amount\n }\n}\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("Mutation 需遵守 Vue 的响应规则")])]),a("ol",[a("li",[t._v("最好提前在你的 store 中初始化好所有所需属性。")]),a("li",[t._v("当需要在对象上添加新属性时，你应该 使用 Vue.set(obj, 'newProp', 123), 或者以新对象替换老对象。：")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[t._v("state.obj = { ...state.obj, "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("newProp")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[t._v("123")]),t._v(" };\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("使用常量替代 Mutation 事件类型")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// mutation-types.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("const")]),t._v(" SOME_MUTATION = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"SOME_MUTATION"')]),t._v(";\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// store.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("import")]),t._v(" Vuex "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v("'vuex'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("import")]),t._v(" { SOME_MUTATION } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v("'./mutation-types'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("const")]),t._v(" store = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("new")]),t._v(" Vuex.Store({\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("state")]),t._v(": { ... },\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("mutations")]),t._v(": {\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// 我们可以使用 ES2015 风格的计算属性命名功能来使用一个常量作为函数名")]),t._v("\n   [SOME_MUTATION] (state) {\n     "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// mutate state")]),t._v("\n   }\n }\n})\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[t._v("在组件中提交 Mutation")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[t._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("import")]),t._v(" { mapMutations } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"vuex"')]),t._v(";\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[t._v("default")]),t._v(" {\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// ...")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("methods")]),t._v(": {\n   ...mapMutations([\n     "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"increment"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// 将 `this.increment()` 映射为 `this.$store.commit('increment')`")]),t._v("\n\n     "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// `mapMutations` 也支持载荷：")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"incrementBy"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit('incrementBy', amount)`")]),t._v("\n   ]),\n   ...mapMutations({\n     "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[t._v("add")]),t._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[t._v('"increment"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[t._v("// 将 `this.add()` 映射为 `this.$store.commit('increment')`")]),t._v("\n   }),\n },\n};\n")])])],2)],1)},n=[],r=a("2877"),p={},v=Object(r["a"])(p,e,n,!1,null,null,null);s["default"]=v.exports}}]);
//# sourceMappingURL=chunk-2d225f0d.f29a7a80.js.map