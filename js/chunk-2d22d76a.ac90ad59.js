(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22d76a"],{f835:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("Node.js Buffer(缓冲区)")])]),a("p",[s._v("JavaScript 语言自身只有字符串数据类型，没有二进制数据类型。\n但在处理像 TCP 流或文件流时，必须使用到二进制数据。\n在 Node.js 中，定义了一个 Buffer 类，该类用来创建一个专门存放二进制数据的缓存区。")])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("Buffer 与字符编码")])]),a("p",[s._v("Node.js 目前支持的字符编码包括：")]),a("ol",[a("li",[s._v("ascii - 仅支持 7 位 ASCII 数据。如果设置去掉高位的话，这种编码是非常快的。")]),a("li",[s._v("utf8 - 多字节编码的 Unicode 字符。许多网页和其他文档格式都使用 UTF-8 。")]),a("li",[s._v("utf16le - 2 或 4 个字节，小字节序编码的 Unicode 字符。支持代理对（U+10000 至 U+10FFFF）。")]),a("li",[s._v("ucs2 - utf16le 的别名。")]),a("li",[s._v("base64 - Base64 编码。")]),a("li",[s._v("latin1 - 一种把 Buffer 编码成一字节编码的字符串的方式。")]),a("li",[s._v("binary - latin1 的别名。")]),a("li",[s._v("hex - 将每个字节编码为两个十六进制字符。")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"runoob"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ascii"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"hex"')]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 72756e6f6f62")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"base64"')]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 cnVub29i")]),s._v("\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("创建 Buffer 类")])]),a("p",[s._v("Node.js 目前支持的字符编码包括：")]),a("ol",[a("li",[s._v("Buffer.alloc(size[, fill[, encoding]])： 返回一个指定大小的 Buffer 实例，如果没有设置 fill，则默认填满 0")]),a("li",[s._v("Buffer.allocUnsafe(size)： 返回一个指定大小的 Buffer 实例，但是它不会被初始化，所以它可能包含敏感的数据")]),a("li",[s._v("Buffer.allocUnsafeSlow(size)")]),a("li",[s._v("Buffer.from(array)： 返回一个被 array 的值初始化的新的 Buffer 实例（传入的 array 的元素只能是数字，不然就会自动被 0 覆盖）")]),a("li",[s._v("Buffer.from(arrayBuffer[, byteOffset[, length]])： 返回一个新建的与给定的 ArrayBuffer 共享同一内存的 Buffer。")]),a("li",[s._v("Buffer.from(buffer)： 复制传入的 Buffer 实例的数据，并返回一个新的 Buffer 实例")]),a("li",[s._v("Buffer.from(string[, encoding])： 返回一个被 string 的值初始化的新的 Buffer 实例")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个长度为 10、且用 0 填充的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf1 = Buffer.alloc("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个长度为 10、且用 0x1 填充的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf2 = Buffer.alloc("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个长度为 10、且未初始化的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这个方法比调用 Buffer.alloc() 更快，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 但返回的 Buffer 实例可能包含旧数据，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 因此需要使用 fill() 或 write() 重写。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf3 = Buffer.allocUnsafe("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个包含 [0x1, 0x2, 0x3] 的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf4 = Buffer.from(["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]);\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个包含 UTF-8 字节 [0x74, 0xc3, 0xa9, 0x73, 0x74] 的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf5 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"tést"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个包含 Latin-1 字节 [0x74, 0xe9, 0x73, 0x74] 的 Buffer。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf6 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"tést"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"latin1"')]),s._v(");\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("写入缓冲区")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("buf.write(string[, offset[, length]][, encoding])\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("buf = Buffer.alloc("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("256")]),s._v(");\nlen = buf.write("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"www.runoob.com"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"写入字节数 : "')]),s._v(" + len); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//写入字节数 : 14")]),s._v("\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("从缓冲区读取数据")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("buf = Buffer.alloc("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("26")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("26")]),s._v("; i++) {\n buf[i] = i + "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("97")]),s._v(";\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ascii"')]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出: abcdefghijklmnopqrstuvwxyz")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ascii"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//使用 'ascii' 编码, 并输出: abcde")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"utf8"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用 'utf8' 编码, 并输出: abcde")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf.toString("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(")); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用默认的 'utf8' 编码, 并输出: abcde")]),s._v("\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("abcdefghijklmnopqrstuvwxyz;\nabcde;\nabcde;\nabcde;\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("将 Buffer 转换为 JSON 对象")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" buf = Buffer.from(["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0x1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0x2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0x3")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0x4")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0x5")]),s._v("]);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" json = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".stringify(buf);\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 输出: {"type":"Buffer","data":[1,2,3,4,5]}')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(json);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" copy = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("JSON")]),s._v(".parse(json, (key, value) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value && value.type === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Buffer"')]),s._v(" ? Buffer.from(value.data) : value;\n});\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出: <Buffer 01 02 03 04 05>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(copy);\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("缓冲区合并")])]),a("p",[s._v("语法："),a("code",{pre:!0},[s._v("Buffer.concat(list[, totalLength])")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer1 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"菜鸟教程"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer2 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"www.runoob.com"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer3 = Buffer.concat([buffer1, buffer2]);\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"buffer3 内容: "')]),s._v(" + buffer3.toString());\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("缓冲区比较")])]),a("p",[s._v("语法："),a("code",{pre:!0},[s._v("buf.compare(otherBuffer);")])]),a("blockquote",[a("p",[s._v("等于 0 相同。大于 0 在之后，小于 0 在之前")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer1 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ABC"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer2 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ABCD"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" result = buffer1.compare(buffer2);\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (result < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buffer1 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 在 "')]),s._v(" + buffer2 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"之前"')]),s._v(");\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (result == "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buffer1 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 与 "')]),s._v(" + buffer2 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"相同"')]),s._v(");\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buffer1 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 在 "')]),s._v(" + buffer2 + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"之后"')]),s._v(");\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//输出结果ABC在ABCD之前")]),s._v("\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("拷贝缓冲区")])]),a("p",[s._v("语法："),a("code",{pre:!0},[s._v("buf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]]);")])]),a("ol",[a("li",[s._v("targetBuffer - 要拷贝的 Buffer 对象。")]),a("li",[s._v("targetStart - 数字, 可选, 默认: 0")]),a("li",[s._v("sourceStart - 数字, 可选, 默认: 0")]),a("li",[s._v("sourceEnd - 数字, 可选, 默认: buffer.length")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buf1 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"abcdefghijkl"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buf2 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"RUNOOB"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//将 buf2 插入到 buf1 指定位置上")]),s._v("\nbuf2.copy(buf1, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(buf1.toString());\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//输出结果abRUNOOBijkl")]),s._v("\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("缓冲区裁剪")])]),a("p",[s._v("语法："),a("code",{pre:!0},[s._v("buf.slice([start[, end]]);")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer1 = Buffer.from("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"runoob"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 剪切缓冲区")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" buffer2 = buffer1.slice("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"buffer1 : "')]),s._v(" + buffer1.toString()); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//buffer1 : runoob")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"buffer2 : "')]),s._v(" + buffer2.toString()); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//buffer2 : ru")]),s._v("\n")])])],2)],1)},e=[],l=a("2877"),p={},n=Object(l["a"])(p,r,e,!1,null,null,null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2d22d76a.ac90ad59.js.map