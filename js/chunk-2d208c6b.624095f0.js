(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d208c6b"],{a5de:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("服务器端渲染 (SSR)")])]),a("p",[s._v("Vue.js 是构建客户端应用程序的框架。默认情况下，可以在浏览器中输出 Vue 组件，进行生成 DOM 和操作 DOM。")]),a("p",[s._v("与传统 SPA (单页应用程序 (Single-Page Application)) 相比，服务器端渲染 (SSR) 的优势主要在于：")]),a("ol",[a("li",[s._v("更好的 SEO，由于搜索引擎爬虫抓取工具可以直接查看完全渲染的页面。")]),a("li",[s._v("更快的内容到达时间 (time-to-content)，特别是对于缓慢的网络情况或运行缓慢的设备。无需等待所有的 JavaScript 都完成下载并执行，才显示服务器渲染的标记，所以你的用户将会更快速地看到完整渲染的页面。通常可以产生更好的用户体验，并且对于那些「内容到达时间(time-to-content) 与转化率直接相关」的应用程序而言，服务器端渲染 (SSR) 至关重要。")])]),a("p",[s._v("使用服务器端渲染 (SSR) 时还需要有一些权衡之处：")]),a("ol",[a("li",[s._v("开发条件所限。浏览器特定的代码，只能在某些生命周期钩子函数 (lifecycle hook) 中使用；一些外部扩展库 (external library) 可能需要特殊处理，才能在服务器渲染应用程序中运行。")]),a("li",[s._v("涉及构建设置和部署的更多要求。与可以部署在任何静态文件服务器上的完全静态单页面应用程序 (SPA) 不同，服务器渲染应用程序，需要处于 Node.js server 运行环境。")]),a("li",[s._v("更多的服务器端负载。在 Node.js 中渲染完整的应用程序，显然会比仅仅提供静态文件的 server 更加大量占用 CPU 资源 (CPU-intensive - CPU 密集)，因此如果你预料在高流量环境 (high traffic) 下使用，请准备相应的服务器负载，并明智地采用缓存策略。")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("安装")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-bash"},[s._v("bash")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install vue vue-server-renderer --save\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("渲染一个 Vue 实例")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第 1 步：创建一个 Vue 实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" Vue = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" app = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vue({\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<div>Hello World</div>`")]),s._v(",\n});\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第 2 步：创建一个 renderer")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" renderer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue-server-renderer"')]),s._v(").createRenderer();\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 第 3 步：将 Vue 实例渲染为 HTML")]),s._v("\nrenderer.renderToString(app, (err, html) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (err) "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" err;\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(html);\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// => <div data-server-rendered="true">Hello World</div>')]),s._v("\n});\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 在 2.5.0+，如果没有传入回调函数，则会返回 Promise：")]),s._v("\nrenderer\n .renderToString(app)\n .then("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("html")]),s._v(") =>")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(html);\n })\n .catch("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("err")]),s._v(") =>")]),s._v(" {\n   "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".error(err);\n });\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("与服务器集成")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-bash"},[s._v("bash")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install express --save\n")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" Vue = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" server = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"express"')]),s._v(")();\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" renderer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue-server-renderer"')]),s._v(").createRenderer();\n\nserver.get("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"*"')]),s._v(", (req, res) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" app = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vue({\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": {\n     "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": req.url,\n   },\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<div>访问的 URL 是： {{ url }}</div>`")]),s._v(",\n });\n\n renderer.renderToString(app, (err, html) => {\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (err) {\n     res.status("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(").end("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Internal Server Error"')]),s._v(");\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(";\n   }\n   res.end("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('`\n     <!DOCTYPE html>\n     <html lang="en">\n       <head><title>Hello</title></head>\n       <body>'),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${html}")]),s._v("</body>\n     </html>\n   `")]),s._v(");\n });\n});\n\nserver.listen("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8080")]),s._v(");\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("使用一个页面模板")])]),a("p",[s._v("index.template.html")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-html"},[s._v("html")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("<!DOCTYPE "),a("span",{pre:!0,attrs:{class:"hljs-meta-keyword"}},[s._v("html")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lang")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"en"')]),s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("head")]),s._v(">")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("title")]),s._v(">")]),s._v("Hello"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("title")]),s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("head")]),s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!--vue-ssr-outlet--\x3e")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),a("p",[s._v("读取和传输文件到 Vue renderer 中：")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" renderer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue-server-renderer"')]),s._v(").createRenderer({\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(").readFileSync("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./index.template.html"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"utf-8"')]),s._v("),\n});\n\nrenderer.renderToString(app, (err, html) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(html); "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// html 将是注入应用程序内容的完整页面")]),s._v("\n});\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("模板插值")])]),a("p",[s._v("模板还支持简单插值。给定如下模板")]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-html"},[s._v("html")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("head")]),s._v(">")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- 使用双花括号(double-mustache)进行 HTML 转义插值(HTML-escaped interpolation) --\x3e")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("title")]),s._v(">")]),s._v("{{ title }}"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("title")]),s._v(">")]),s._v("\n\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- 使用三花括号(triple-mustache)进行 HTML 不转义插值(non-HTML-escaped interpolation) --\x3e")]),s._v("\n   {{{ meta }}}\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("head")]),s._v(">")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!--vue-ssr-outlet--\x3e")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("body")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),a("p",[s._v('通过传入一个"渲染上下文对象"，作为 renderToString 函数的第二个参数，来提供插值数据：')]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" context = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"hello"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("meta")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`\n   <meta ...>\n   <meta ...>\n `")]),s._v(",\n};\n\nrenderer.renderToString(app, context, (err, html) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 页面 title 将会是 "Hello"')]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// meta 标签也会注入")]),s._v("\n});\n")])])],2),a("hv-snippet",{attrs:{title:""}},[a("template",{slot:"title"},[a("p",[s._v("完整实例代码")])]),a("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" Vue = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue"')]),s._v(");\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" server = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"express"')]),s._v(")();\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" template = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(").readFileSync("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./index.template.html"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"utf-8"')]),s._v(");\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" renderer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue-server-renderer"')]),s._v(").createRenderer({\n template,\n});\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" context = {\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"vue ssr"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("metas")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('`\n       <meta name="keyword" content="vue,ssr">\n       <meta name="description" content="vue srr demo">\n   `')]),s._v(",\n};\n\nserver.get("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"*"')]),s._v(", (req, res) => {\n "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" app = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vue({\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": {\n     "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("url")]),s._v(": req.url,\n   },\n   "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<div>访问的 URL 是： {{ url }}</div>`")]),s._v(",\n });\n\n renderer.renderToString(app, context, (err, html) => {\n   "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(html);\n   "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (err) {\n     res.status("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(").end("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Internal Server Error"')]),s._v(");\n     "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(";\n   }\n   res.end(html);\n });\n});\n\nserver.listen("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8080")]),s._v(");\n")])])],2)],1)},e=[],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d208c6b.624095f0.js.map