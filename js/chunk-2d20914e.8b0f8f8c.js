(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20914e"],{a812:function(s,t,r){"use strict";r.r(t);var a=function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("hv-snippet",{attrs:{title:""}},[r("template",{slot:"title"},[r("p",[s._v("Node.js 多进程")])]),r("p",[s._v("Node.js 是以单线程的模式运行的，但它使用的是事件驱动来处理并发，这样有助于我们在多核 cpu 的系统上创建多个子进程，从而提高性能。\n每个子进程总是带有三个流对象：child.stdin, child.stdout 和 child.stderr。他们可能会共享父进程的 stdio 流，或者也可以是独立的被导流的流对象。")]),r("p",[s._v("Node 提供了 child_process 模块来创建子进程，方法有：")]),r("ol",[r("li",[s._v("exec - child_process.exec 使用子进程执行命令，缓存子进程的输出，并将子进程的输出以回调函数参数的形式返回。")]),r("li",[s._v("spawn - child_process.spawn 使用指定的命令行参数创建新进程。")]),r("li",[s._v("fork - child_process.fork 是 spawn()的特殊形式，用于在子进程中运行的模块，如 fork('./son.js') 相当于 spawn('node', ['./son.js']) 。与 spawn 方法不同的是，fork 会在父进程与子进程之间，建立一个通信管道，用于进程之间的通信。")])])],2),r("hv-snippet",{attrs:{title:""}},[r("template",{slot:"title"},[r("p",[s._v("exec() 方法")])]),r("p",[s._v("语法："),r("code",{pre:!0},[s._v("child_process.exec(command[, options], callback)")])]),r("ol",[r("li",[s._v("command： 字符串， 将要运行的命令，参数使用空格隔开")]),r("li",[s._v("callback ：回调函数，包含三个参数 error, stdout 和 stderr。")]),r("li",[s._v("options ：对象，可以是：")])]),r("p",[s._v("cwd ，字符串，子进程的当前工作目录\nenv，对象 环境变量键值对\nencoding ，字符串，字符编码（默认： 'utf8'）\nshell ，字符串，将要执行命令的 Shell\ntimeout，数字，超时时间（默认： 0）\nmaxBuffer，数字， 在 stdout 或 stderr 中允许存在的最大缓冲（二进制），如果超出那么子进程将会被杀死 （默认: 200*1024）\nkillSignal ，字符串，结束信号（默认：'SIGTERM'）\nuid，数字，设置用户进程的 ID\ngid，数字，设置进程组的 ID")]),r("blockquote",[r("p",[s._v("exec() 方法返回最大的缓冲区，并等待进程结束，一次性返回缓冲区的内容。")])]),r("p",[s._v("support.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"进程 "')]),s._v(" + process.argv["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("] + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 执行。"')]),s._v(");\n")])]),r("p",[s._v("master.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fs = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" child_process = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child_process"')]),s._v(");\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("; i++) {\n "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" workerProcess = child_process.exec("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"node support.js "')]),s._v(" + i, "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("\n   error,\n   stdout,\n   stderr\n ")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (error) {\n     "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(error.stack);\n     "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Error code: "')]),s._v(" + error.code);\n     "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Signal received: "')]),s._v(" + error.signal);\n   }\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stdout: "')]),s._v(" + stdout);\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stderr: "')]),s._v(" + stderr);\n });\n\n workerProcess.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"exit"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("code")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"子进程已退出，退出码 "')]),s._v(" + code);\n });\n}\n")])]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("子进程已退出，退出码 0\nstdout: 进程 1 执行。\n\nstderr:\n子进程已退出，退出码 0\nstdout: 进程 0 执行。\n\nstderr:\n子进程已退出，退出码 0\nstdout: 进程 2 执行。\n\nstderr:\n")])])],2),r("hv-snippet",{attrs:{title:""}},[r("template",{slot:"title"},[r("p",[s._v("spawn() 方法")])]),r("p",[s._v("语法："),r("code",{pre:!0},[s._v("child_process.spawn(command[, args][, options])")])]),r("ol",[r("li",[s._v("command： 字符串， 将要运行的命令，参数使用空格隔开")]),r("li",[s._v("args ：Array 字符串参数数组")]),r("li",[s._v("options :Object\ncwd String 子进程的当前工作目录\nenv Object 环境变量键值对\nstdio Array|String 子进程的 stdio 配置\ndetached Boolean 这个子进程将会变成进程组的领导\nuid Number 设置用户进程的 ID\ngid Number 设置进程组的 ID")])]),r("blockquote",[r("p",[s._v("exec() 方法返回最大的缓冲区，并等待进程结束，一次性返回缓冲区的内容。")])]),r("p",[s._v("support.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"进程 "')]),s._v(" + process.argv["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("] + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 执行。"')]),s._v(");\n")])]),r("p",[s._v("master.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fs = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" child_process = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child_process"')]),s._v(");\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("; i++) {\n "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" workerProcess = child_process.spawn("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"node"')]),s._v(", ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"support.js"')]),s._v(", i]);\n\n workerProcess.stdout.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("data")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stdout: "')]),s._v(" + data);\n });\n\n workerProcess.stderr.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("data")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stderr: "')]),s._v(" + data);\n });\n\n workerProcess.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"close"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("code")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"子进程已退出，退出码 "')]),s._v(" + code);\n });\n}\n")])]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("stdout: 进程 0 执行。\n\n子进程已退出，退出码 0\nstdout: 进程 1 执行。\n\n子进程已退出，退出码 0\nstdout: 进程 2 执行。\n\n子进程已退出，退出码 0\n")])])],2),r("hv-snippet",{attrs:{title:""}},[r("template",{slot:"title"},[r("p",[s._v("fork 方法")])]),r("p",[s._v("语法："),r("code",{pre:!0},[s._v("child_process.fork(modulePath[, args][, options])")])]),r("ol",[r("li",[s._v("modulePath： String，将要在子进程中运行的模块")]),r("li",[s._v("args ：Array 字符串参数数组")]),r("li",[s._v("options Object ：\ncwd String 子进程的当前工作目录\nenv Object 环境变量键值对\nstdio Array|String 子进程的 stdio 配置\ndetached Boolean 这个子进程将会变成进程组的领导\nuid Number 设置用户进程的 ID\ngid Number 设置进程组的 ID")])]),r("blockquote",[r("p",[s._v("exec() 方法返回最大的缓冲区，并等待进程结束，一次性返回缓冲区的内容。")])]),r("p",[s._v("support.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"进程 "')]),s._v(" + process.argv["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("] + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('" 执行。"')]),s._v(");\n")])]),r("p",[s._v("master.js")]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-javascript"},[s._v("javascript")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fs = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fs"')]),s._v(");\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" child_process = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child_process"')]),s._v(");\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("; i++) {\n "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" workerProcess = child_process.spawn("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"node"')]),s._v(", ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"support.js"')]),s._v(", i]);\n\n workerProcess.stdout.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("data")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stdout: "')]),s._v(" + data);\n });\n\n workerProcess.stderr.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("data")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stderr: "')]),s._v(" + data);\n });\n\n workerProcess.on("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"close"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("code")]),s._v(") ")]),s._v("{\n   "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"子进程已退出，退出码 "')]),s._v(" + code);\n });\n}\n")])]),r("div",{staticClass:"hv-snippet--tag hv-snippet--tag-result"},[s._v("result")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-result"}},[s._v("stdout: 进程 0 执行。\n\n子进程已退出，退出码 0\nstdout: 进程 1 执行。\n\n子进程已退出，退出码 0\nstdout: 进程 2 执行。\n\n子进程已退出，退出码 0\n")])])],2)],1)},n=[],e=r("2877"),p={},l=Object(e["a"])(p,a,n,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d20914e.8b0f8f8c.js.map