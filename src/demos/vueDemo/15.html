<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <style>
    </style>
    <script>
        window.onload = function () {
            Vue.component('async-a', function (resolve, reject) {
                setTimeout(function () {
                    resolve({
                        template: '<div>我是async。</div>'
                    });
                    //  reject(reason);
                }, 5000);
            });
            new Vue({
                el: '#async-a-demo'
            });

            // //将异步组件和 webpack 的 code-splitting 功能一起配合使用
            // Vue.component('async-b', function (resolve) {
            //     // 这个特殊的 `require` 语法将会告诉 webpack
            //     // 自动将你的构建代码切割成多个包，这些包
            //     // 会通过 Ajax 请求加载
            //     require(['./my-async-component'], resolve);
            // });
            //在工厂函数中返回一个 Promise
            Vue.component(
                'async-b',
                // 这个 `import` 函数会返回一个 `Promise` 对象。
                () => import('./my-async-component.js')
            );

            new Vue({
                el: '#async-b-demo'
            });

            new Vue({
                el: '#async-c-demo',
                components: {
                    'async-c': () => import('./my-async-component.js')
                }
            });
            var LoadingComponent = {
                /* ... */
            };
            var ErrorComponent = {
                /* ... */
            };
            //处理加载状态
            let AsyncComponent = () => ({
                // 需要加载的组件 (应该是一个 `Promise` 对象)
                component: import('../MyComponent.vue'),
                // 异步组件加载时使用的组件
                loading: LoadingComponent,
                // 加载失败时使用的组件
                error: ErrorComponent,
                // 展示加载时组件的延时时间。默认值是 200 (毫秒)
                delay: 200,
                // 如果提供了超时时间且组件加载也超时了，
                // 则使用加载失败时使用的组件。默认值是：`Infinity`
                timeout: 3000
            });

            new Vue({
                el: '#my-component-demo',
                components: {
                    myComponent: () => AsyncComponent
                }
            });
            //
        };
    </script>
</head>

<body>
    <div id="async-a-demo">
        async-a
        <async-a></async-a>
    </div>
    <div id="async-b-demo">
        async-b
        <async-b></async-b>
    </div>
    <div id="async-c-demo">
        async-c
        <async-c></async-c>
    </div>
    <div id="my-component-demo">
        <my-component></my-component>
    </div>
</body>

</html>